<!DOCTYPE HTML> 
<html>
<head>
<meta name="viewport" content="width=320; user-scalable=no" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Minimal AppLaud App</title>
<link rel="styleSheet" href="index.css"/>
<script type="text/javascript" charset="utf-8" src="phonegap-1.4.1.js"></script>

<script type="text/javascript" charset="utf-8">


function getCurrentPosition() {
var map = document.getElementById('map');

  function success(pos) { 
  /*var text = "<div>Latitude: " + pos.coords.latitude + "<br/>" + "Longitude: " + pos.coords.longitude + "<br/>" + "Accuracy: " + pos.coords.accuracy + "m<br/>" + "</div>";
  document.getElementById('cur_position').innerHTML = text;
  console.log(text);*/
  map.style.display ='block';
  var mapwidth = 250; // a mungy compromise between the 2 sizes
  var mapheight = 250; // since we can't get w / h dynamically
  map.src ="http://maps.googleapis.com/maps/api/staticmap?center=" + 
  pos.coords.latitude +"," + pos.coords.longitude + "&zoom=14&size=" + mapwidth + "x" + mapheight + "&maptype=roadmap&markers=color:green%7C" +
  pos.coords.latitude +"," + pos.coords.longitude + "&sensor=false";
  };

  function fail(error) {
  document.getElementById('cur_position').innerHTML = "Error getting geolocation: " + error.code;console.log("Error getting geolocation: code=" + error.code + " message=" + error.message);};
  map.style.display ='none';
  document.getElementById('cur_position').innerHTML = "Getting geolocation . . .";
  console.log("Getting geolocation . . .");
  navigator.geolocation.getCurrentPosition(success, fail);  
};

/*
var watchID = null;
function clearWatch() { 
if (watchID !== null) {
navigator.geolocation.clearWatch(watchID);
watchID = null;
document.getElementById('cur_position').innerHTML = "";
document.getElementById('map').style.display = 'none';
}
}

function varwsuccess(pos) { 
var map = document.getElementById('map');
document.getElementById('cur_position').innerHTML = "Watching geolocation . . .";
map.style.display ='none';
var text = "<div>Latitude: " + pos.coords.latitude + " (watching)<br/>" + "Longitude: " + pos.coords.longitude + "<br/>" + "Accuracy: " + pos.coords.accuracy + "m<br/>" + "</div>";
document.getElementById('cur_position').innerHTML = text;
console.log(text);
map.style.display ='block';
var mapwidth = 270; // a mungy compromise between the 2 sizes
var mapheight = 210; // since we can't get w / h dynamically
map.src ="http://maps.googleapis.com/maps/api/staticmap?center=" + pos.coords.latitude +"," + pos.coords.longitude + "&zoom=13&size=" + mapwidth + "x" + mapheight + "&maptype=roadmap&markers=color:green%7C" +pos.coords.latitude +"," + pos.coords.longitude + "&sensor=false";
};


function varwfail(error) { 
document.getElementById('cur_position').innerHTML = "Error getting geolocation: " + error.code;
console.log("Error getting geolocation: code=" + error.code + " message=" + error.message);
};


function toggleWatchPosition() { 
if (watchID) {
console.log(
"Stopped watching position");
clearWatch();// sets watchID = null;
}
else { 
document.getElementById(
'map').style.display = 'none';
document.getElementById(
'cur_position').innerHTML = "Watching geolocation . . .";
console.log("Watching geolocation . . .");
var options = { frequency: 3000, maximumAge: 5000, timeout: 5000, enableHighAccuracy: true };
watchID = navigator.geolocation.watchPosition(wsuccess, wfail, options);
}
};
*/
</script>


</head>
<body>
<h2>Geolocation</h2>

<a class="btn deux" onclick="toggleWatchPosition();">Toggle</a>
<a class="btn deux" onclick="getCurrentPosition();">Get Current</a>
<div class="result-block">
<span id="cur_position"></span>
</div>
<img id="map" alt="Location Map"/> 
</div>
</div>
</body> 
</html>
